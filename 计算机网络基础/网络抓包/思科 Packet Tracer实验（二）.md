# 思科 Packet Tracer实验（二）

## 7.生成树协议STP的功能

目的：验证交换机生成树协议STP的功能。

1.设置4台交换机，形成物理环路，我们发现有一条线是闭塞的，是因为交换机会自动闭合线路，不让整个线路形成逻辑环路，并是两台PC连接上面两台交换机，配置IP分别为：`192.168.0.1`和`192.168.0.2`：

![](D:/笔记/Linux/计算机网络基础/网络抓包/思科 Packet Tracer.assets/2022-11-23_114328.png)

2.尽管交换机有一条线路是不通的，但两台交换机可以通过另一线路通信，我们可以点击计算机通过`桌面`中的`命令提示符``ping`一下另外的主机：

![image-20221123114148196](D:/笔记/Linux/计算机网络基础/网络抓包/思科 Packet Tracer.assets/image-20221123114148196.png)

3.我们可以看到尽管`交换机0--交换1`的线路不通，但`192.168.0.1`的计算机可以通过`交换机0--交换机3--交换机2--交换机1`的这条线路到达`192.168.0.2`的计算机，我们模拟这个结点中某个交换机出现了问题会是什么样的。用交换机3举例，点击交换机3，在`配置`中点击接口1，让它的接口1关闭，这个时候就没办法`ping`通了：

![](D:/笔记/Linux/计算机网络基础/网络抓包/思科 Packet Tracer.assets/Video_2022-11-23_114935.gif)



4.人为设置故障后，过一段时间（切换实时/仿真），原本不通的链路又恢复了，是因为我们认为设置了故障，生成树协议会发现异常，然后自动修复阻塞链路。这个时候再去`ping`就通了，再打开交换机3的接口，再发现原来的故障被生成树协议又阻塞了：

![](D:/笔记/Linux/计算机网络基础/网络抓包/思科 Packet Tracer.assets/Video_2022-11-25_094120.gif)



5.进入交换机用命令方式关闭交换机生成树协议，以交换机0为例，点击进入命令行界面，按回车后输入以下命令：

```shell
enable					
config							# 配置模式
no spanning-tree vlan 1			# 关闭vlan1（虚拟局域网）的生成树协议
```

以同样的方式关闭其他几台交换机的生成树协议：

![](D:/笔记/Linux/计算机网络基础/网络抓包/思科 Packet Tracer.assets/Video_2022-11-25_100942-1669344236311.gif)



6.关闭生成树协议后，就形成了逻辑环路，这个时候发送的广播帧就会在网络中兜圈。选择从`192.168.0.1`发送一个复杂PDU给`255.255.255.255`，我们会发现交换机在无止尽的兜圈，占用了网络资源，再两两主机之间互`ping`，这个时候发现它们不能互连：

![](C:\Users\HP\Desktop\Video_2022-11-25_105225.gif)



## 8.虚拟局域网

目的：如何划分VLAN，以及划分VLAN的作用。

1.构建以下网络拓扑，并设置各主机IP地址：

<img src="C:\Users\HP\AppData\Roaming\Typora\typora-user-images\image-20221126100933599.png" alt="image-20221126100933599" style="zoom:50%;" />

2.打开检查，观察交换机的端口汇总表，可以看到交换机有哪些接口打开，以及它们对应的MAC地址等信息，并切换到仿真模式，保留ICMP协议，以便后续实验观察：

![](C:\Users\HP\Desktop\2022-11-26_101427.png)

<img src="C:\Users\HP\Desktop\2022-11-26_101937.png" style="zoom:50%;" />

3.验证同一VLAN下是否是一个广播域，我们为`192.168.0.1`添加一个复杂PDU，添加一个广播`255.255.255.255`的广播信号，我们验证是否有广播给其他主机，收到广播数据的主机会返回响应。我们再删除这个数据，以便后续实验的进行：

![](思科 Packet Tracer实验（二）.assets/Video_2022-11-26_204642.gif)



4.我们将左边3台主机划分为一个广播域（VLAN2），右边3台主机划分为一个广播域（VLAN3），实际上就是将左边和右边的接口划分到一个广播域，也就是说修改广播域是在交换机上进行的。也就是将1，2，3接口划分到一个广播域，将4，5，6划分到一个广播域。我们点击交换机，在`配置`--`VLAN数据库`中进行设置，我们可以看到有5个默认VLAN，1为默认VLAN，1002-1005为其他用途的VLAN。我们创建VLAN号1和2，VLAN名称为VLAN2和VLAN3，并点击接口1，2，3，设置它们的VLAN为2，点击接口4，5，6，设置它们VLAN为3（如遇接口不同，反复切换实时/仿真），再从`192.168.0.1`发送广播数据，观察到只是VLAN2的主机接收到了数据，并返回请求：

![](思科 Packet Tracer实验（二）.assets/Video_2022-11-26_205900.gif)

上述设置VLAN的方式，在实际情况下都是通过命令行来实现的，点击`交换机`，在`命令行界面`输入以下命令：

```shell
end
exit							# 以上两步回到命令行初始阶段
# 按回车开始命令
enable							# 进入特权模式
config	terminal				# 进入全局配置模式
vlan 3							# 创建VLAN 3 
name VLAN3						# 给3起名VLAN3
end
show vlan brief					# 输出简单vlan信息
config	terminal				# 进入全局配置模式
interface range fastethernet 0/4 - 6		# 设置接口0/4-6
switchport mode access 			#  设置为access模式
switchpoert access vlan	3		# 将4-6接口配置到VLAN3
end
show vlan brief					# 输出简单vlan信息，可以看到VLAN3包含4，5，6接口
```



不在同一VLAN下的主机是不能`ping`通的。

5.将拓扑结构修改为下面的类型（可以全选中复制粘贴），并设置左边3台主机的接口为VLAN2，右边3台主机的接口为VLAN3。这个时候我们从`192.168.0.1`发送复杂PDU以广播的形式发送给其他主机，我们发现这个数据只发送给了`192.168.0.2`和`192.168.0.3`，这是因为接口7在access模式下默认属于VLAN1（提取首部帧不属于VLAN1），我们可以将两台交换机的接口7的模式切换为Trunk（Trunk模式下会转发所有的帧），这个时候删除上面的数据，再让`192.168.0.1`的主机发送广播帧，再观察数据就发送到了下面的主机了：

![image-20221126213325152](思科 Packet Tracer实验（二）.assets/image-20221126213325152.png)



## 9.IPV4地址-分类地址

目的：验证分类IPV4地址的作用，以及对路由器的功能做初步了解。

1.我们建立两台PC直接互联的PC，并设置它们的IP地址是`192.168.0.1`和`192.168.0.2`，我们可以看到它们处于同一类IP地址（C类）。这个时候去`ping`是可以`ping`通的：

![image-20221127174450019](思科 Packet Tracer实验（二）.assets/image-20221127174450019.png)

2.当我们把右边的PC机的IP设置为`172.16.0.1`（B类地址），这个时候由左边的PC去`ping`就超时了，证明IP地址不在一个网络中，是不能互联的：

![image-20221127174743961](思科 Packet Tracer实验（二）.assets/image-20221127174743961.png)



3.删除中间的连接线，我们采用网络层设备--**路由器**连接它们，并设置路由器连接左边的接口的IP地址和左边PC处在同一网段--`192.168.0.254`，并打开该接口，同理，设置右边的接口和右边的PC的IP地址处在同一网段--`172.16.255.254`，并打开该接口，这个时候由左边去`ping`右边是`ping`不通的，因为去`ping`的时候，主机会首先看目的地址是否处在同一网段中，如果不在同一网段是`ping`不通的，我们需要打开两台主机，设置它们的`默认网关`和路由器接口地址一样分别为左边`192.168.0.254`和`192.168.255.254`，告诉它们默认的路由IP，这样才能`ping`通：

![](思科 Packet Tracer实验（二）.assets/Video_2022-11-27_185509.gif)





## 10.IPV4地址--划分子网

